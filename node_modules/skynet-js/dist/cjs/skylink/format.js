"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.formatSkylink = exports.convertSkylinkToBase64 = exports.convertSkylinkToBase32 = void 0;
const sia_1 = require("./sia");
const encoding_1 = require("../utils/encoding");
const string_1 = require("../utils/string");
const url_1 = require("../utils/url");
const validation_1 = require("../utils/validation");
/**
 * Converts the given base64 skylink to base32.
 *
 * @param skylink - The base64 skylink.
 * @returns - The converted base32 skylink.
 */
function convertSkylinkToBase32(skylink) {
    skylink = string_1.trimUriPrefix(skylink, url_1.uriSkynetPrefix);
    validation_1.validateStringLen("skylink", skylink, "parameter", sia_1.BASE64_ENCODED_SKYLINK_SIZE);
    const bytes = encoding_1.decodeSkylinkBase64(skylink);
    return encoding_1.encodeSkylinkBase32(bytes);
}
exports.convertSkylinkToBase32 = convertSkylinkToBase32;
/**
 * Converts the given base32 skylink to base64.
 *
 * @param skylink - The base32 skylink.
 * @returns - The converted base64 skylink.
 */
function convertSkylinkToBase64(skylink) {
    skylink = string_1.trimUriPrefix(skylink, url_1.uriSkynetPrefix);
    validation_1.validateStringLen("skylink", skylink, "parameter", sia_1.BASE32_ENCODED_SKYLINK_SIZE);
    const bytes = encoding_1.decodeSkylinkBase32(skylink);
    return encoding_1.encodeSkylinkBase64(bytes);
}
exports.convertSkylinkToBase64 = convertSkylinkToBase64;
/**
 * Formats the skylink by adding the sia: prefix.
 *
 * @param skylink - The skylink.
 * @returns - The formatted skylink.
 */
function formatSkylink(skylink) {
    if (skylink === "") {
        return skylink;
    }
    if (!skylink.startsWith(url_1.uriSkynetPrefix)) {
        skylink = `${url_1.uriSkynetPrefix}${skylink}`;
    }
    return skylink;
}
exports.formatSkylink = formatSkylink;
